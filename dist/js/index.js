var dataList,len,control,timer,root=window.player,audio=root.audioManager,duration=0;function getData(o){$.ajax({type:"GET",url:o,success:function(o){len=o.length,control=new root.controlIndex(len),dataList=o,root.render(o[0]),root.pro.renderAllTime(o[0].duration),audio.getAudio(o[0].audio),duration=o[0].duration,bindEvent(),bindTouchEvent()},error:function(){}})}function bindEvent(){$("body").on("play:change",function(o,t){root.render(dataList[t]),root.pro.renderAllTime(dataList[t].duration),duration=dataList[t].duration,audio.getAudio(dataList[t].audio),"play"==audio.status?(audio.play(),root.pro.start(0)):root.pro.update(0),$(".img-box").attr("data-deg",0),$(".img-box").css({transform:"rotateZ(0deg)",transition:"none"})}),$(".prev").on("click",function(){var o=control.prev();$("body").trigger("play:change",o)}),$(".next").on("click",function(){var o=control.next();$("body").trigger("play:change",o)}),$(".play").on("click",function(){"pause"==audio.status?(audio.play(),root.pro.start(),rotated($(".img-box").attr("data-deg"))):(audio.pause(),root.pro.stop(),clearInterval(timer));$(".play").toggleClass("playing")})}function bindTouchEvent(){var n=$(".pro-bottom").offset().left,r=$(".pro-bottom").offset().width;$(".spot").on("touchstart",function(o){root.pro.stop()}).on("touchmove",function(o){var t=(o.changedTouches[0].clientX-n)/r;0<=t&&t<1&&root.pro.update(t)}).on("touchend",function(o){var t=(o.changedTouches[0].clientX-n)/r,a=t*duration;0<=t&&t<1&&(audio.playTo(a),audio.play(),root.pro.start(t),$(".play").addClass("playing"))})}function rotated(o){clearInterval(timer),o=+o,timer=setInterval(function(){o+=2,$(".img-box").attr("data-deg",o),$(".img-box").css({transform:"rotateZ("+o+"deg)",transition:"all 1s ease-out"})},200)}$(audio.audio).on("ended",function(){$(".next").trigger("click")}),getData("../mock/data.json");